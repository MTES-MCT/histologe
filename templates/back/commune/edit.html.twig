{% extends 'back/base_bo.html.twig' %}

{% block title %}Modifier la commune {{commune.nom}}{% endblock %}

{% block content %}
    <section class="fr-p-5v">
        {% include 'back/breadcrumb_bo.html.twig' with {
            'level2Title': 'Outils SA',
            'level2Link': '',
            'level2Label': '',
            'level3Title': 'Communes',
            'level3Link': path('back_commune_index'),
            'level4Title': 'Modifier la commune '~ commune.nom,
            'level4Link': '',
        } %}
        <header>
            <div class="fr-grid-row">
                <div class="fr-col-12 fr-text--left">
                    <h1 class="fr-mb-0">Commune {{commune.nom}}</h1>
                </div>
            </div>
        </header>
    </section>

    <section class="fr-grid-row fr-grid-row--gutters fr-px-5v fr-pb-5v">
        <div class="fr-col-6">
            {{form(form, {'attr': {'id': 'form-edit-commune'}} )}}
        </div>
        <div class="fr-col-6">
            {% if countSignalements > 0 %}
                <div class="fr-alert fr-alert--warning">
                    <p>
                        Il y a {{ countSignalements }} signalement(s) associé(s) à cette commune (Code INSEE {{ commune.codeInsee }}).
                        <br>
                        En modifiant le nom de la commune il sera aussi mis à jour dans les signalements associés.
                    </p>
                </div>
            {% else %}
                <div class="fr-alert fr-alert--info">
                    <p>
                        Aucun signalement n'est associé à cette commune (Code INSEE {{ commune.codeInsee }}).
                    </p>
                </div>
            {% endif %}
            {% if inconsistentSignalements|length > 0 %}
                <div class="fr-alert fr-alert--warning fr-mt-2v">
                    <p>
                        Attention, il y a {{ inconsistentSignalements|length }} signalement(s) avec un nom de commune différent du nom actuel ({{ commune.nom }}).
                        <br>
                        Voici la liste des signalements concernés et le nom de commune enregistré :
                    </p>
                    <ul class="fr-mt-2v">
                        {% for signalement in inconsistentSignalements %}
                            <li>
                                <a href="{{ path('back_signalement_view', {uuid: signalement.uuid}) }}">
                                    Signalement #{{ signalement.reference }} - {{ signalement.villeOccupant }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
    </section>

{% endblock %}
